## 로지스틱 회귀분석 : 해석

**회귀계수가 잘 추정되었다는 전제 하에 결과물 해석**

### 성공확률
회귀계수가 추정되고 나면 주어진 설명변수 집합에 대한 성공확률을 다음과 같이 계산할 수 있다.
<img src = "./image/로지스틱회귀/성공확률.JPG" width="60%">


### 로지스틱 함수의 의미

실제 상황에서는 특정 변수에 대한 확률값이 선형이 아닌 S-커브 형태를 따르는 경우가 많다.
- 월소득에 따른 자가 집 보유 확률
- 월소득에 따른 대출 상환 못할 확률 
<img src = "./image/로지스틱회귀/실생활에 유용 예시.JPG" width="70%">

이진 분류를 위한 cut-off 설정 
- Threshold(기준값)
- 일반적으로 0.5가 주로 사용된다.
- 사전확률을 고려하거나 검증 데이터의 정확도를 최대화하는 cut-off가 사용될 수도 있다.
<img src = "./image/로지스틱회귀/cut-off.JPG" width="70%">

- 일반적으로 성공범주는 소수범주이다.(더 중요한 범주)
    - 마케팅에서의 응답고객
    - 금융에서의 금융상품 이용 고객
    - 의료에서 특정 질병의 진단을 받을 환자
    - 제조업에서의 불량 제품

baseline 모델 : 다른 복잡한 모델을 만들었을 때 baseline 모델보다 성능이 좋아야 한다.
- 분류 baseline : 로지스틱 회귀분석
- 회귀 baseline : 선형 회귀분석

### 로지스틱 회귀분석 : 해석

#### 회귀계수의 의미 : 해당 변수가 1증가함에 따른 로그 승산의 변화량
<img src = "./image/로지스틱회귀/로지스틱 회귀분석 식.JPG" width="50%">


#### 승산 비율 : Odds Ratio
- 나머지 변수는 모두 고정시킨 상태에서 한 변수를 1만큼 증가시켰을 때 변화하는 Odds의 비율 
<img src = "./image/로지스틱회귀/승산 비율 식 약분.JPG" width="70%">
- x1이 증가하게 되면 성공에 대한 승산 비율이 $e^{\beta_1}$만큼 변화한다.


- 회귀계수가 양수 $\rightarrow$ 변수가 증가하면 성공 확률이 **증가** (성공범주와 설명변수 양의 상관관계)
- 회귀계수가 음수 $\rightarrow$ 변수가 증가하면 성공 확률이 **감소** (성공범주와 설명변수 음의 상관관계)
<img src = "./image/로지스틱회귀/내 그림.JPG" width="30%">


#### 로지스틱 회귀분석 결과 및 해석
- 로지스틱 회귀분석을 수행하고 나면 선형 회귀분석과 유사하게 다음과 같은 표를 결과로 얻을 수 있다.
<img src = "./image/로지스틱회귀/로지스틱 해석 표.JPG" width="70%">

- 회귀계수(Coefficient)
    - 베타값
    - **해당 변수가 1단위 증가할 때 로그승산비의 변화량**을 의미한다.
    - 양수이면 성공확률과 양의 상관관계, 음수이면 성공확률과 음의 상관관계
- 유의확률(p-value)
    - 해당 변수가 통계적으로 유의미한지 여부를 알려주는 지표
    - 0에 가까울수록 모델링에 중요한 변수, 1에 가까울수록 중요하지 않은 변수
    - 특정 유의수준($\alpha$)을 설정해서 해당 값 미만의 변수만을 사용하여 다시 로지스틱 회귀분석을 구축하는 것도 가능하다.(주로 $\alpha$=0.05 사용)
- 승산비율(Odds Ratio)
    - 나머지 변수는 모두 고정시킨 상태에서 한 변수를 1만큼 증가시켰을 때 변화하는 Odds의 비율

#### 신용카드 연체 예측
- 단변량 로지스틱 회귀분석 
    - 변수 1개 : balance
    <img src = "./image/로지스틱회귀/단변량.JPG" width="70%">
- 다변량 로지스틱 회귀분석 
    - 변수 여러 개 : balance, income, student
    <img src = "./image/로지스틱회귀/다변량.JPG" width="70%">

## 다항 로지스틱 회귀분석

- 로지스틱 회귀분석을 범주가 3개 이상인 다범주 분류에 적용하는 방식이다.
- 기준(Baseline)이 되는 범주를 설정하고 이 범주 대비 다른 범주가 발생할 로그 승산을 회귀식으로 추정한다.
<img src = "./image/로지스틱회귀/다항 그림.JPG" width="50%">


- 3개의 범주를 가진 분류 문제의 경우 회귀계수 추정
    - 기준 : 3번 범주
     <img src = "./image/로지스틱회귀/다항 회귀식 2개.jpg" width="70%">

$\Rightarrow$ 2개의 회귀식 추정

$\Rightarrow$ 사용하는 범주와 데이터가 다르기 때문에 추정된 회귀식도 다름


- 왜 범주는 3개인데 2개의 모형만 학습하는가?
    - 각 범주에 속할 확률의 합은 항상 1이므로 나머지 k번째 범주에 대한 확률은 자동으로 산출된다.
    <img src = "./image/로지스틱회귀/다항 3범주 회귀식.JPG" width="60%">
    
#### 다항 로지스틱 회귀분석에서의 회귀계수 분석 
- 개별 모형에 대해서 회귀계수와 이에 대한 유의확률을 산출할 수 있다.
    - Total phenols, Flavanoids, Monflavanoid penols, Hue, OD280~ 변수는 1 vs 3, 2 vs 3에서 모든 유의미한 변수로 나타난다.
    - Ash., Proanthocyanins 변수는 범주 1과 3을 구분할 때는 유의미하지 않으나 2와 3을 구분할 때 매우 유의미하다.
    <img src = "./image/로지스틱회귀/다항 회귀분석 해석.JPG" width="70%">
